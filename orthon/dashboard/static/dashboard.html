<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRISM Live Analysis Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <link rel="stylesheet" href="/static/dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <header class="dashboard-header">
            <h1>PRISM Live Analysis</h1>
            <div class="status-indicator" id="connection-status">
                <span class="status-dot" id="status-dot"></span>
                <span id="status-text">Connecting...</span>
            </div>
            <div class="source-selector">
                <label for="source-select">Data Source:</label>
                <select id="source-select">
                    <option value="turbofan">Turbofan Simulator</option>
                    <option value="reactor">Chemical Reactor</option>
                    <option value="crypto">Crypto Markets</option>
                    <option value="system">System Metrics</option>
                    <option value="synthetic">Synthetic Data</option>
                </select>
                <button id="connect-btn" onclick="toggleConnection()">Connect</button>
            </div>
        </header>

        <div class="dashboard-grid">
            <!-- Key Metrics Panel -->
            <div class="panel metrics-panel">
                <h2>Real-Time Metrics</h2>

                <div class="metric-card" id="eff-dim-card">
                    <div class="metric-label">Effective Dimension</div>
                    <div class="metric-value" id="eff-dim-value">--</div>
                    <div class="metric-trend" id="eff-dim-trend"></div>
                </div>

                <div class="metric-card" id="eigenval-card">
                    <div class="metric-label">Primary Eigenvalue</div>
                    <div class="metric-value" id="eigenval-value">--</div>
                    <div class="metric-trend" id="eigenval-trend"></div>
                </div>

                <div class="metric-card" id="lyapunov-card">
                    <div class="metric-label">Lyapunov Exponent</div>
                    <div class="metric-value" id="lyapunov-value">Calculating...</div>
                    <div class="metric-status" id="lyapunov-status"></div>
                </div>

                <div class="metric-card" id="status-card">
                    <div class="metric-label">Analysis Stage</div>
                    <div class="metric-value small" id="stage-value">Initializing</div>
                    <div class="progress-bar">
                        <div class="progress" id="analysis-progress"></div>
                    </div>
                </div>
            </div>

            <!-- Charts Panel -->
            <div class="panel charts-panel">
                <h2>Time Series</h2>

                <div class="chart-container">
                    <canvas id="eff-dim-chart"></canvas>
                </div>

                <div class="chart-container">
                    <canvas id="eigenvals-chart"></canvas>
                </div>
            </div>

            <!-- Alerts Panel -->
            <div class="panel alerts-panel">
                <h2>Alerts</h2>
                <div id="alerts-container">
                    <div class="no-alerts">No active alerts</div>
                </div>
            </div>

            <!-- System Info Panel -->
            <div class="panel info-panel">
                <h2>System Info</h2>

                <div class="info-row">
                    <span>Samples Processed:</span>
                    <span id="sample-count">0</span>
                </div>

                <div class="info-row">
                    <span>Data Source:</span>
                    <span id="data-source">--</span>
                </div>

                <div class="info-row">
                    <span>Uptime:</span>
                    <span id="uptime">0s</span>
                </div>

                <div class="info-row">
                    <span>Update Rate:</span>
                    <span id="update-rate">-- Hz</span>
                </div>

                <div class="buffer-status">
                    <div>Window Buffer: <span id="window-fill">0%</span></div>
                    <div class="buffer-bar">
                        <div class="buffer-progress" id="window-progress"></div>
                    </div>

                    <div>Batch Buffer: <span id="batch-fill">0%</span></div>
                    <div class="buffer-bar">
                        <div class="buffer-progress" id="batch-progress"></div>
                    </div>
                </div>
            </div>

            <!-- Raw Data Panel -->
            <div class="panel raw-data-panel">
                <h2>Raw Sensor Data</h2>
                <div id="raw-data-container" class="raw-data-grid">
                    <div class="no-data">Waiting for data...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/dashboard.js"></script>
</body>
</html>
